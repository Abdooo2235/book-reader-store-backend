{
  "info": {
    "_postman_id": "book-reader-api-v4",
    "name": "ðŸ“š Book Reader API",
    "description": "Free Book Store & Reader Platform API - Fixed for Collection Runner",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {"key": "base_url", "value": "https://book-reader-store-backend.onrender.com/api"},
    {"key": "test_email", "value": ""},
    {"key": "user_auth", "value": ""},
    {"key": "admin_auth", "value": ""},
    {"key": "book_id", "value": ""},
    {"key": "collection_id", "value": ""},
    {"key": "order_id", "value": ""},
    {"key": "review_id", "value": ""},
    {"key": "category_id", "value": ""},
    {"key": "user_id", "value": ""}
  ],
  "item": [
    {
      "name": "ðŸ”“ Public",
      "item": [
        {
          "name": "Books",
          "item": [
            {
              "name": "List Approved Books",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.data && json.data.data.length > 0) {", "    pm.collectionVariables.set('book_id', json.data.data[0].id);", "    console.log('âœ… book_id saved: ' + json.data.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}],
                "url": "{{base_url}}/books"
              }
            },
            {
              "name": "Get Book Details",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}],
                "url": "{{base_url}}/books/{{book_id}}"
              }
            },
            {
              "name": "Get Book Reviews",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}],
                "url": "{{base_url}}/books/{{book_id}}/reviews"
              }
            }
          ]
        },
        {
          "name": "Categories",
          "item": [
            {
              "name": "List Categories",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.length > 0) {", "    pm.collectionVariables.set('category_id', json.data[0].id);", "    console.log('âœ… category_id saved: ' + json.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}],
                "url": "{{base_url}}/categories"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ðŸ” Authentication",
      "item": [
        {
          "name": "Register",
          "event": [
            {"listen": "prerequest", "script": {"exec": ["const randomEmail = `user_${Date.now()}@example.com`;", "pm.collectionVariables.set('test_email', randomEmail);", "console.log('ðŸ“§ Generated email: ' + randomEmail);"], "type": "text/javascript"}},
            {"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.token) {", "    pm.collectionVariables.set('user_auth', json.data.token);", "    pm.collectionVariables.set('user_id', json.data.user.id);", "    console.log('âœ… user_auth saved!');", "}"], "type": "text/javascript"}}
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\n    \"name\": \"Test User\",\n    \"email\": \"{{test_email}}\",\n    \"password\": \"password\",\n    \"password_confirmation\": \"password\"\n}"},
            "url": "{{base_url}}/auth/register"
          }
        },
        {
          "name": "Login",
          "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.token) {", "    pm.collectionVariables.set('user_auth', json.data.token);", "    pm.collectionVariables.set('user_id', json.data.user.id);", "    console.log('âœ… user_auth saved!');", "}"], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\n    \"email\": \"test123@gmail.com\",\n    \"password\": \"password\"\n}"},
            "url": "{{base_url}}/auth/login"
          }
        },
        {
          "name": "Get Current User",
          "request": {
            "method": "GET",
            "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
            "url": "{{base_url}}/auth/user"
          }
        }
      ]
    },
    {
      "name": "ðŸ‘¤ User",
      "item": [
        {
          "name": "Profile",
          "item": [
            {
              "name": "Get Profile",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/profile"
              }
            },
            {
              "name": "Update Profile",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"name\": \"Updated Name\"\n}"},
                "url": "{{base_url}}/profile"
              }
            },
            {
              "name": "Upload Avatar",
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "formdata", "formdata": [{"key": "avatar", "type": "file", "src": ""}]},
                "url": "{{base_url}}/profile/avatar"
              }
            },
            {
              "name": "Delete Avatar",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/profile/avatar"
              }
            }
          ]
        },
        {
          "name": "Preferences",
          "item": [
            {
              "name": "Get Preferences",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/preferences"
              }
            },
            {
              "name": "Update Preferences",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"theme\": \"dark\",\n    \"font_size\": 18\n}"},
                "url": "{{base_url}}/preferences"
              }
            }
          ]
        },
        {
          "name": "My Books (Submissions)",
          "item": [
            {
              "name": "List My Submissions",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/my-books"
              }
            },
            {
              "name": "Submit New Book",
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "formdata", "formdata": [{"key": "title", "value": "My New Book", "type": "text"}, {"key": "author", "value": "John Author", "type": "text"}, {"key": "description", "value": "Book description", "type": "text"}, {"key": "category_id", "value": "{{category_id}}", "type": "text"}, {"key": "file_type", "value": "pdf", "type": "text"}, {"key": "number_of_pages", "value": "100", "type": "text"}, {"key": "book_file", "type": "file", "src": ""}, {"key": "cover_image", "type": "file", "src": ""}]},
                "url": "{{base_url}}/books"
              }
            },
            {
              "name": "Delete Pending Book",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/my-books/{{book_id}}"
              }
            }
          ]
        },
        {
          "name": "Cart",
          "item": [
            {
              "name": "View Cart",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/cart"
              }
            },
            {
              "name": "Add Book to Cart",
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/cart/books/{{book_id}}"
              }
            },
            {
              "name": "Remove Book from Cart",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/cart/books/{{book_id}}"
              }
            },
            {
              "name": "Checkout",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.id) {", "    pm.collectionVariables.set('order_id', json.data.id);", "    console.log('âœ… order_id saved: ' + json.data.id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/cart/checkout"
              }
            }
          ]
        },
        {
          "name": "Orders",
          "item": [
            {
              "name": "List Orders",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.length > 0) {", "    pm.collectionVariables.set('order_id', json.data[0].id);", "    console.log('âœ… order_id saved: ' + json.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/orders"
              }
            },
            {
              "name": "Get Order Details",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/orders/{{order_id}}"
              }
            }
          ]
        },
        {
          "name": "Library",
          "item": [
            {
              "name": "View Library",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.data && json.data.data.length > 0) {", "    pm.collectionVariables.set('book_id', json.data.data[0].id);", "    console.log('âœ… book_id saved from library');", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/library"
              }
            },
            {
              "name": "Download Book",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/library/{{book_id}}/download"
              }
            }
          ]
        },
        {
          "name": "Favorites",
          "item": [
            {
              "name": "Get All Favorites",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/favorites"
              }
            },
            {
              "name": "Add to Favorites",
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/library/{{book_id}}/favorite"
              }
            },
            {
              "name": "Remove from Favorites",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/library/{{book_id}}/favorite"
              }
            }
          ]
        },
        {
          "name": "Collections",
          "item": [
            {
              "name": "List Collections",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.length > 0) {", "    pm.collectionVariables.set('collection_id', json.data[0].id);", "    console.log('âœ… collection_id saved: ' + json.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/collections"
              }
            },
            {
              "name": "Get Collection Books",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/collections/{{collection_id}}/books"
              }
            },
            {
              "name": "Add Book to Collection",
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"book_id\": \"{{book_id}}\"\n}"},
                "url": "{{base_url}}/collections/{{collection_id}}/books"
              }
            },
            {
              "name": "Remove Book from Collection",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/collections/{{collection_id}}/books/{{book_id}}"
              }
            }
          ]
        },
        {
          "name": "Reading Progress",
          "item": [
            {
              "name": "List All Progress",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/progress"
              }
            },
            {
              "name": "Get Book Progress",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/progress/{{book_id}}"
              }
            },
            {
              "name": "Update Progress",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"last_page\": 50,\n    \"total_pages\": 100\n}"},
                "url": "{{base_url}}/progress/{{book_id}}"
              }
            }
          ]
        },
        {
          "name": "Reviews",
          "item": [
            {
              "name": "Create Review",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.id) {", "    pm.collectionVariables.set('review_id', json.data.id);", "    console.log('âœ… review_id saved: ' + json.data.id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"rating\": 5,\n    \"review_text\": \"Great book!\"\n}"},
                "url": "{{base_url}}/books/{{book_id}}/reviews"
              }
            },
            {
              "name": "Update Review",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"rating\": 4,\n    \"review_text\": \"Updated review\"\n}"},
                "url": "{{base_url}}/reviews/{{review_id}}"
              }
            },
            {
              "name": "Delete Review",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
                "url": "{{base_url}}/reviews/{{review_id}}"
              }
            }
          ]
        },
        {
          "name": "ðŸ”š Logout",
          "request": {
            "method": "POST",
            "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{user_auth}}"}],
            "url": "{{base_url}}/auth/logout"
          }
        }
      ]
    },
    {
      "name": "ðŸ›¡ï¸ Admin",
      "item": [
        {
          "name": "Admin Login",
          "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.token) {", "    pm.collectionVariables.set('admin_auth', json.data.token);", "    console.log('âœ… admin_auth saved!');", "}"], "type": "text/javascript"}}],
          "request": {
            "method": "POST",
            "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}],
            "body": {"mode": "raw", "raw": "{\n    \"email\": \"admin@bookreader.com\",\n    \"password\": \"password\"\n}"},
            "url": "{{base_url}}/auth/login"
          }
        },
        {
          "name": "Dashboard",
          "item": [
            {
              "name": "Get Dashboard Stats",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/stats"
              }
            }
          ]
        },
        {
          "name": "Books Management",
          "item": [
            {
              "name": "List All Books",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.data && json.data.data.length > 0) {", "    pm.collectionVariables.set('book_id', json.data.data[0].id);", "    console.log('âœ… book_id saved: ' + json.data.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/books"
              }
            },
            {
              "name": "Get Book Details",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/books/{{book_id}}"
              }
            },
            {
              "name": "Update Book",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"title\": \"Updated Title\"\n}"},
                "url": "{{base_url}}/admin/books/{{book_id}}"
              }
            },
            {
              "name": "Approve Book",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/books/{{book_id}}/approve"
              }
            },
            {
              "name": "Reject Book",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"rejection_reason\": \"Content not appropriate\"\n}"},
                "url": "{{base_url}}/admin/books/{{book_id}}/reject"
              }
            },
            {
              "name": "Delete Book",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/books/{{book_id}}"
              }
            }
          ]
        },
        {
          "name": "Categories Management",
          "item": [
            {
              "name": "List Categories",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.length > 0) {", "    pm.collectionVariables.set('category_id', json.data[0].id);", "    console.log('âœ… category_id saved: ' + json.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/categories"
              }
            },
            {
              "name": "Create Category",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.id) {", "    pm.collectionVariables.set('category_id', json.data.id);", "    console.log('âœ… category_id saved: ' + json.data.id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "POST",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"name\": \"New Category\"\n}"},
                "url": "{{base_url}}/admin/categories"
              }
            },
            {
              "name": "Update Category",
              "request": {
                "method": "PUT",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Content-Type", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "body": {"mode": "raw", "raw": "{\n    \"name\": \"Updated Category\"\n}"},
                "url": "{{base_url}}/admin/categories/{{category_id}}"
              }
            },
            {
              "name": "Delete Category",
              "request": {
                "method": "DELETE",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/categories/{{category_id}}"
              }
            }
          ]
        },
        {
          "name": "Users Management",
          "item": [
            {
              "name": "List Users",
              "event": [{"listen": "test", "script": {"exec": ["var json = pm.response.json();", "if(json.data && json.data.length > 0) {", "    pm.collectionVariables.set('user_id', json.data[0].id);", "    console.log('âœ… user_id saved: ' + json.data[0].id);", "}"], "type": "text/javascript"}}],
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/users"
              }
            },
            {
              "name": "Get User Details",
              "request": {
                "method": "GET",
                "header": [{"key": "Accept", "value": "application/json"}, {"key": "Authorization", "value": "Bearer {{admin_auth}}"}],
                "url": "{{base_url}}/admin/users/{{user_id}}"
              }
            }
          ]
        }
      ]
    }
  ]
}
